<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœ€é•·é€£çºŒ 1 (Max Consecutive Ones) - ç·šæ€§æƒæ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .transition-all-500 { transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1); }
        .fade-in { animation: fadeIn 0.5s forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* æ•¸å­—æ–¹å¡Š (RWD è‡ªé©æ‡‰) */
        .num-box {
            display: flex;
            align-items: center;
            justify-content: center;
            /* é—œéµä¿®æ”¹ï¼šå½ˆæ€§å¯¬åº¦ + ä¿æŒæ­£æ–¹å½¢ */
            flex: 1 1 0px; 
            max-width: 3.5rem; /* æœ€å¤§å¯¬åº¦ */
            aspect-ratio: 1 / 1; /* ä¿æŒæ­£æ–¹å½¢ */
            min-width: 1.5rem; /* æœ€å°å¯¬åº¦é˜²æ­¢è®Šå¤ªå°çœ‹ä¸è¦‹ */
            
            border-radius: 0.5rem; /* éš¨å¯¬åº¦è®Šå°ç¨å¾®èª¿æ•´åœ“è§’è¦–æ„Ÿ */
            font-weight: bold;
            font-family: monospace;
            /* å­—é«”å¤§å°éš¨è¦–çª—æˆ–å®¹å™¨è‡ªé©æ‡‰ï¼Œé€™è£¡ç”¨ clamp æˆ–ç°¡å–®çš„ rem */
            font-size: clamp(1rem, 2.5vw, 1.5rem); 
            
            transition: all 0.4s ease;
            border: 2px solid transparent;
            position: relative;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        }
        
        .num-box.one {
            background-color: #eff6ff; /* blue-50 */
            color: #1d4ed8; /* blue-700 */
            border-color: #dbeafe;
        }
        
        .num-box.zero {
            background-color: #f9fafb; /* gray-50 */
            color: #9ca3af; /* gray-400 */
            border-color: #e5e7eb;
        }

        /* ç‹€æ…‹æ¨£å¼ */
        .num-box.active {
            transform: translateY(-8px) scale(1.1); /* å‘ä¸Šæµ®å‹• */
            z-index: 20;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        
        .num-box.counting {
            background-color: #3b82f6 !important; /* blue-500 */
            color: white !important;
            border-color: #2563eb !important;
        }

        .num-box.reset {
            background-color: #ef4444 !important; /* red-500 */
            color: white !important;
            border-color: #dc2626 !important;
            animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both;
        }

        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }
    </style>
</head>
<body class="bg-slate-50 min-h-screen font-sans text-slate-800 flex flex-col">

    <!-- Header -->
    <nav class="bg-white border-b border-slate-200 px-6 py-4 shadow-sm sticky top-0 z-50">
        <div class="max-w-5xl mx-auto flex flex-col md:flex-row justify-between items-center gap-4">
            <h1 class="text-xl font-bold text-slate-900 flex items-center gap-2">
                <svg class="text-blue-500" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12h20"/><path d="M7 2v20"/><path d="M17 2v20"/></svg>
                æœ€é•·é€£çºŒ 1 (Max Consecutive Ones)
            </h1>
            <div class="flex bg-slate-100 p-1 rounded-lg overflow-x-auto max-w-full">
                <button onclick="app.generateData(1)" class="whitespace-nowrap px-3 py-1.5 rounded-md text-sm font-bold bg-white shadow-sm text-blue-600 transition-all hover:bg-slate-50">éš¨æ©Ÿé™£åˆ—</button>
                <button onclick="app.generateData(2)" class="whitespace-nowrap px-3 py-1.5 rounded-md text-sm font-bold text-slate-500 hover:text-slate-700 transition-all">å…¨ 1 æ¡ˆä¾‹</button>
                <button onclick="app.generateData(3)" class="whitespace-nowrap px-3 py-1.5 rounded-md text-sm font-bold text-slate-500 hover:text-slate-700 transition-all">äº¤éŒ¯æ¡ˆä¾‹</button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-grow p-4 md:p-8 max-w-5xl mx-auto w-full space-y-6 flex flex-col">

        <!-- Array Visualization Area (Full Width) -->
        <div class="bg-white rounded-2xl shadow-md border border-slate-200 relative min-h-[250px] flex flex-col items-center justify-center p-6 select-none overflow-hidden w-full">
            
            <div class="absolute top-4 left-4 text-xs font-bold text-slate-400 uppercase tracking-wider">ç·šæ€§æƒæéç¨‹</div>

            <!-- Array Container -->
            <!-- Modified: flex-nowrap (no wrap), w-full, justify-center -->
            <div id="array-container" class="flex flex-nowrap py-10 px-2 gap-1 md:gap-2 relative w-full justify-center items-center">
                <!-- JS Injected Boxes -->
            </div>

            <!-- Status Text -->
            <div class="mt-4 text-base font-mono text-slate-500 font-medium h-8" id="scan-status">æº–å‚™å°±ç·’...</div>

        </div>

        <!-- Bottom Panel: Concept, Stats & Controls -->
        <div class="grid md:grid-cols-2 gap-6">
            
            <!-- Left: Concept & Stats -->
            <div class="space-y-6">
                <!-- Concept -->
                <div class="bg-white p-5 rounded-2xl shadow-sm border border-slate-200">
                    <h2 class="text-sm font-bold text-slate-800 mb-2 border-l-4 border-blue-500 pl-3">æ ¸å¿ƒé‚è¼¯</h2>
                    <div class="flex gap-4 text-xs font-mono bg-slate-50 p-3 rounded-lg border border-slate-100">
                        <div class="flex-1">
                            <span class="text-green-600 font-bold block mb-1">é‡åˆ° 1</span>
                            <span class="text-slate-600">W += 1; maxW = max(maxW, W)</span>
                        </div>
                        <div class="w-px bg-slate-200"></div>
                        <div class="flex-1">
                            <span class="text-red-500 font-bold block mb-1">é‡åˆ° 0</span>
                            <span class="text-slate-600">W = 0 (æ­¸é›¶)</span>
                        </div>
                    </div>
                </div>

                <!-- Stats -->
                <div class="bg-slate-800 p-5 rounded-2xl text-white shadow-lg">
                    <div class="text-xs font-bold text-slate-400 uppercase mb-4 border-b border-slate-700 pb-2 flex justify-between">
                        <span>è®Šæ•¸è¿½è¹¤</span>
                        <span class="text-slate-500 font-mono text-[10px]">O(N) Time, O(1) Space</span>
                    </div>
                    
                    <div class="space-y-5">
                        <!-- W -->
                        <div>
                            <div class="flex justify-between items-end mb-1">
                                <span class="text-sm font-bold text-blue-300">W (Current Width)</span>
                                <span class="text-2xl font-mono font-bold text-white transition-all" id="val-w">0</span>
                            </div>
                            <div class="w-full bg-slate-700 rounded-full h-2 overflow-hidden">
                                <div id="bar-w" class="bg-blue-500 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                            </div>
                        </div>

                        <!-- maxW -->
                        <div>
                            <div class="flex justify-between items-end mb-1">
                                <span class="text-sm font-bold text-green-400">maxW (Max Width)</span>
                                <span class="text-3xl font-mono font-bold text-yellow-400 transition-all" id="val-maxw">0</span>
                            </div>
                            <div class="w-full bg-slate-700 rounded-full h-2 overflow-hidden">
                                <div id="bar-maxw" class="bg-green-500 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right: Controls -->
            <div class="flex flex-col justify-center gap-4 bg-white p-6 rounded-2xl shadow-sm border border-slate-200">
                <div class="text-center mb-2">
                    <span class="text-xs font-bold text-slate-400 uppercase tracking-widest">æ“ä½œæ§åˆ¶</span>
                </div>
                
                <button onclick="app.nextStep()" id="btn-next" class="w-full py-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold shadow-lg shadow-blue-200 transition-all flex items-center justify-center gap-3 active:scale-[0.98] text-lg">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
                    ä¸‹ä¸€æ­¥
                </button>
                
                <div class="grid grid-cols-2 gap-4 mt-2">
                    <button onclick="app.autoPlay()" id="btn-auto" class="py-3 bg-indigo-50 hover:bg-indigo-100 text-indigo-600 rounded-xl font-bold text-sm transition-all border border-indigo-100 flex items-center justify-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>
                        <span id="txt-auto">è‡ªå‹•æ’­æ”¾</span>
                    </button>
                    <button onclick="app.reset()" class="py-3 bg-slate-50 hover:bg-slate-100 text-slate-600 rounded-xl font-bold text-sm transition-all border border-slate-200 flex items-center justify-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 12"/><path d="M3 3v9h9"/></svg>
                        é‡ç½®
                    </button>
                </div>
            </div>

        </div>

    </main>

    <script>
        const app = {
            // Data
            nums: [],
            
            // State
            index: -1,
            w: 0,
            maxW: 0,
            isAutoPlaying: false,
            timer: null,

            init() {
                this.generateData(1);
            },

            generateData(type) {
                this.resetState();
                
                if (type === 1) {
                    // Random (More elements to show shrinking effect)
                    this.nums = Array.from({length: 18}, () => Math.random() > 0.4 ? 1 : 0);
                } else if (type === 2) {
                    this.nums = Array(15).fill(1);
                } else {
                    this.nums = [1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1];
                }
                
                this.renderArray();
                this.updateUI();
            },

            resetState() {
                this.stopAutoPlay();
                this.index = -1;
                this.w = 0;
                this.maxW = 0;
                
                const btn = document.getElementById('btn-next');
                btn.disabled = false;
                btn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg> é–‹å§‹æƒæ`;
                btn.className = "w-full py-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold shadow-lg shadow-blue-200 transition-all flex items-center justify-center gap-3 active:scale-[0.98] text-lg";
                
                document.getElementById('scan-status').innerHTML = "æº–å‚™å°±ç·’... é»æ“Šä¸‹ä¸€æ­¥é–‹å§‹";
            },

            reset() {
                this.resetState();
                this.renderArray(); // Reset visuals
                this.updateUI();
            },

            nextStep() {
                if (this.index >= this.nums.length - 1) {
                    this.finish();
                    return;
                }

                // Move index
                this.index++;
                const currentVal = this.nums[this.index];
                
                // Logic
                const statusEl = document.getElementById('scan-status');
                const box = document.getElementById(`box-${this.index}`);
                
                // Scroll to view doesn't make much sense in single row auto-fit, but good to keep if overflow happens
                // box.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
                
                // Reset previous highlighting
                if(this.index > 0) {
                    const prevBox = document.getElementById(`box-${this.index-1}`);
                    prevBox.classList.remove('active', 'ring-4', 'ring-blue-300');
                }

                // Highlight Current
                box.classList.add('active', 'ring-4', 'ring-indigo-300');

                if (currentVal === 1) {
                    // Encounter 1
                    this.w++;
                    
                    box.classList.add('counting');
                    statusEl.innerHTML = `<span class="text-blue-600 font-bold">é‡åˆ° 1</span> : W åŠ  1 (${this.w})`;
                    
                    if (this.w > this.maxW) {
                        this.maxW = this.w;
                        statusEl.innerHTML += ` â†’ <span class="text-green-600 font-bold">æ›´æ–° maxW!</span>`;
                        // Visual effect for maxW update
                        document.getElementById('val-maxw').classList.add('scale-150', 'text-green-500');
                        setTimeout(() => document.getElementById('val-maxw').classList.remove('scale-150', 'text-green-500'), 300);
                    }
                } else {
                    // Encounter 0
                    this.w = 0;
                    
                    box.classList.add('reset');
                    statusEl.innerHTML = `<span class="text-red-500 font-bold">é‡åˆ° 0</span> : é€£çºŒä¸­æ–·ï¼ŒW æ­¸é›¶`;
                }

                this.updateUI();
                
                // Update Button Text
                const btn = document.getElementById('btn-next');
                if (this.index === this.nums.length - 1) {
                    btn.innerHTML = "å®Œæˆ (æŸ¥çœ‹çµæœ)";
                } else {
                    btn.innerHTML = "ä¸‹ä¸€æ­¥";
                }
            },

            autoPlay() {
                if (this.isAutoPlaying) {
                    this.stopAutoPlay();
                    return;
                }
                
                this.isAutoPlaying = true;
                const btnAuto = document.getElementById('btn-auto');
                const txtAuto = document.getElementById('txt-auto');
                
                txtAuto.innerText = "æš«åœ";
                btnAuto.classList.replace('bg-indigo-50', 'bg-red-50');
                btnAuto.classList.replace('text-indigo-600', 'text-red-600');
                btnAuto.querySelector('svg').innerHTML = `<rect x="6" y="4" width="4" height="16"></rect><rect x="14" y="4" width="4" height="16"></rect>`; // Pause icon
                
                document.getElementById('btn-next').disabled = true;
                document.getElementById('btn-next').classList.add('opacity-50', 'cursor-not-allowed');

                this.timer = setInterval(() => {
                    if (this.index >= this.nums.length - 1) {
                        this.finish();
                    } else {
                        this.nextStep();
                    }
                }, 500); // Speed
            },

            stopAutoPlay() {
                this.isAutoPlaying = false;
                clearInterval(this.timer);
                
                const btnAuto = document.getElementById('btn-auto');
                const txtAuto = document.getElementById('txt-auto');
                
                txtAuto.innerText = "è‡ªå‹•æ’­æ”¾";
                btnAuto.classList.replace('bg-red-50', 'bg-indigo-50');
                btnAuto.classList.replace('text-red-600', 'text-indigo-600');
                btnAuto.querySelector('svg').innerHTML = `<polygon points="5 3 19 12 5 21 5 3"/>`; // Play icon
                
                document.getElementById('btn-next').disabled = false;
                document.getElementById('btn-next').classList.remove('opacity-50', 'cursor-not-allowed');
            },

            finish() {
                this.stopAutoPlay();
                const btn = document.getElementById('btn-next');
                btn.disabled = true;
                btn.innerHTML = "ğŸ‰ æƒæçµæŸ";
                btn.className = "w-full py-4 bg-green-600 text-white rounded-xl font-bold shadow-md cursor-default text-lg";
                
                document.getElementById('scan-status').innerHTML = `<span class="text-green-600 font-bold text-lg">æœ€çµ‚çµæœï¼šæœ€å¤§é€£çºŒå¯¬åº¦ç‚º ${this.maxW}</span>`;
                
                // Remove active highlight from last one
                const lastBox = document.getElementById(`box-${this.nums.length-1}`);
                if(lastBox) lastBox.classList.remove('active', 'ring-4');
            },

            renderArray() {
                const container = document.getElementById('array-container');
                // Removed shrink-0, added classes in CSS for flex behavior
                container.innerHTML = this.nums.map((n, i) => `
                    <div id="box-${i}" class="num-box ${n===1 ? 'one' : 'zero'}">
                        ${n}
                        <div class="absolute -bottom-6 text-[10px] text-slate-300 font-normal opacity-0 hover:opacity-100 transition-opacity">${i}</div>
                    </div>
                `).join('');
            },

            updateUI() {
                // Update Values
                document.getElementById('val-w').innerText = this.w;
                document.getElementById('val-maxw').innerText = this.maxW;

                // Update Progress Bars (Visual only, approximate scale)
                const maxPossible = this.nums.length || 1;
                document.getElementById('bar-w').style.width = `${(this.w / maxPossible) * 100}%`;
                document.getElementById('bar-maxw').style.width = `${(this.maxW / maxPossible) * 100}%`;
            }
        };

        app.init();
    </script>
</body>
</html>